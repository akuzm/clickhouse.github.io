










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="ja">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>ClickHouseテストの実行方法 | ClickHouseドキュメント</title>
    <link rel="canonical" href="https://clickhouse.tech/docs/ja/development/tests/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "ClickHouseテストの実行方法 | ClickHouseドキュメント",
"mainEntityOfPage": "https://clickhouse.tech/docs/ja/development/tests/",

"datePublished": "2017-10-25T08:27:09+03:00",
"dateModified": "2020-05-15T07:34:54+03:00",

"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "ClickHouseテストの実行方法 | ClickHouseドキュメント",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}footer{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}ul{margin-top:0;margin-bottom:1rem}ul ul{margin-bottom:0}b,strong{font-weight:bolder}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2.5rem}.h2,h2{font-size:2rem}.h3,h3{font-size:1.75rem}.h4,h4{font-size:1.5rem}.h5,h5{font-size:1.25rem}.h6,h6{font-size:1rem}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-0{-ms-flex-order:0;order:0}.order-1{-ms-flex-order:1;order:1}.order-2{-ms-flex-order:2;order:2}.order-3{-ms-flex-order:3;order:3}.order-4{-ms-flex-order:4;order:4}.order-5{-ms-flex-order:5;order:5}.order-6{-ms-flex-order:6;order:6}.order-7{-ms-flex-order:7;order:7}.order-8{-ms-flex-order:8;order:8}.order-9{-ms-flex-order:9;order:9}.order-10{-ms-flex-order:10;order:10}.order-11{-ms-flex-order:11;order:11}.order-12{-ms-flex-order:12;order:12}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-md-0{-ms-flex-order:0;order:0}.order-md-1{-ms-flex-order:1;order:1}.order-md-2{-ms-flex-order:2;order:2}.order-md-3{-ms-flex-order:3;order:3}.order-md-4{-ms-flex-order:4;order:4}.order-md-5{-ms-flex-order:5;order:5}.order-md-6{-ms-flex-order:6;order:6}.order-md-7{-ms-flex-order:7;order:7}.order-md-8{-ms-flex-order:8;order:8}.order-md-9{-ms-flex-order:9;order:9}.order-md-10{-ms-flex-order:10;order:10}.order-md-11{-ms-flex-order:11;order:11}.order-md-12{-ms-flex-order:12;order:12}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-lg-0{-ms-flex-order:0;order:0}.order-lg-1{-ms-flex-order:1;order:1}.order-lg-2{-ms-flex-order:2;order:2}.order-lg-3{-ms-flex-order:3;order:3}.order-lg-4{-ms-flex-order:4;order:4}.order-lg-5{-ms-flex-order:5;order:5}.order-lg-6{-ms-flex-order:6;order:6}.order-lg-7{-ms-flex-order:7;order:7}.order-lg-8{-ms-flex-order:8;order:8}.order-lg-9{-ms-flex-order:9;order:9}.order-lg-10{-ms-flex-order:10;order:10}.order-lg-11{-ms-flex-order:11;order:11}.order-lg-12{-ms-flex-order:12;order:12}}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-primary{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:hover{color:#fff;background-color:#0069d9;border-color:#0062cc}.btn-primary:focus{color:#fff;background-color:#0069d9;border-color:#0062cc;box-shadow:0 0 0 .2rem rgba(38,143,255,.5)}.btn-primary:disabled{color:#fff;background-color:#007bff;border-color:#007bff}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-primary{color:#007bff;border-color:#007bff}.btn-outline-primary:hover{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:focus{box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}.btn-outline-primary:disabled{color:#007bff;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}.btn-group{position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}.btn-group>.btn{position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.btn-group>.btn:hover{z-index:1}.btn-group>.btn:active,.btn-group>.btn:focus{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}.custom-file{position:relative;display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);margin-bottom:0}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary .alert-link{color:#002752}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-primary{background-color:#007bff}a.bg-primary:focus,a.bg-primary:hover{background-color:#0062cc}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-right{float:right}.float-lg-none{float:none}}.fixed-top{position:fixed;top:0;right:0;left:0;z-index:1030}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.m-0{margin:0}.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.m-1{margin:.25rem}.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.m-2{margin:.5rem}.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.m-3{margin:1rem}.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.m-4{margin:1.5rem}.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.m-5{margin:3rem}.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pb-0,.py-0{padding-bottom:0}.pl-0{padding-left:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.pl-1{padding-left:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.pl-2{padding-left:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pb-3,.py-3{padding-bottom:1rem}.pl-3{padding-left:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.pl-4{padding-left:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pb-5,.py-5{padding-bottom:3rem}.pl-5{padding-left:3rem}.m-n1{margin:-.25rem}.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.m-n2{margin:-.5rem}.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.m-n3{margin:-1rem}.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.m-n4{margin:-1.5rem}.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.m-n5{margin:-3rem}.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}@media(min-width:768px){.m-md-0{margin:0}.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.m-md-1{margin:.25rem}.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.m-md-2{margin:.5rem}.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.m-md-3{margin:1rem}.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.m-md-4{margin:1.5rem}.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.m-md-5{margin:3rem}.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pb-md-0,.py-md-0{padding-bottom:0}.pl-md-0{padding-left:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.pl-md-1{padding-left:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.pl-md-2{padding-left:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.pl-md-3{padding-left:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.pl-md-4{padding-left:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.pl-md-5{padding-left:3rem}.m-md-n1{margin:-.25rem}.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.m-md-n2{margin:-.5rem}.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.m-md-n3{margin:-1rem}.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.m-md-n4{margin:-1.5rem}.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.m-md-n5{margin:-3rem}.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}}@media(min-width:992px){.m-lg-0{margin:0}.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.m-lg-1{margin:.25rem}.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.m-lg-2{margin:.5rem}.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.m-lg-3{margin:1rem}.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.m-lg-4{margin:1.5rem}.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.m-lg-5{margin:3rem}.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.pl-lg-0{padding-left:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.pl-lg-1{padding-left:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.pl-lg-2{padding-left:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.pl-lg-3{padding-left:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.pl-lg-4{padding-left:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.pl-lg-5{padding-left:3rem}.m-lg-n1{margin:-.25rem}.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.m-lg-n2{margin:-.5rem}.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.m-lg-n3{margin:-1rem}.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.m-lg-n4{margin:-1.5rem}.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.m-lg-n5{margin:-3rem}.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-primary{color:#007bff}a.text-primary:focus,a.text-primary:hover{color:#0056b3}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-orange{color:#f14600}.headerlink{text-decoration:none;margin-left:.5rem}body[data-spy] #content{overflow-x:scroll}#content code{color:#111;background:#eee}#content pre{background:#eee;padding:1rem}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body.blog,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content code,#content pre{background:#444;color:#eee}}.syntax{background:#f8f9fa;color:#2f1e2e}.syntax .c{color:#8d8687}.syntax .k{color:#815ba4}.syntax .n{color:#2f1e2e}.syntax .o{color:#5bc4bf}.syntax .p{color:#2f1e2e}.syntax .cp{color:#8d8687}.syntax .c1{color:#8d8687}.syntax .ld{color:#48b685}.syntax .m{color:#f99b15}.syntax .s{color:#48b685}.syntax .no{color:#ef6155}.syntax .py{color:#2f1e2e}.syntax .mi{color:#f99b15}.syntax .s2{color:#48b685}.syntax .sh{color:#48b685}.syntax .s1{color:#48b685}@media(prefers-color-scheme:dark){.syntax .k{color:#c78cff}.syntax .ld{color:#64ffbb}.syntax .s{color:#64ffbb}.syntax .s2{color:#64ffbb}.syntax .sh{color:#64ffbb}.syntax .s1{color:#64ffbb}.syntax .c{color:#64ffbb}.syntax .n{color:#f8f9fa}.syntax .p{color:#f8f9fa}.syntax .py{color:#f8f9fa}}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
    <div class="alert alert-primary" role="alert">
      <p class="display-5 mb-2">助けが欲しかった！</p>
      <p class="lead">このドキュメントページの以下の内容は機械翻訳されています。 異な他のウェブサイトで行われませんができます。 この翻訳テキスト生活をGitHubリポジトリとClickHouseコードベース、待ち員ネイティブスピーカーで人間が読む. <a href="/docs/en/development/tests/" class="alert-link">また、参照として、元の英語版を使用することができます。</a></p>
      <p class="lead">
          <a class="btn btn-lg btn-primary text-white" href="https://github.com/ClickHouse/ClickHouse/edit/master/docs/ja/development/tests.md" target="_blank" rel="external nofollow noreferrer">
              このページを編集してClickHouseの文書を編集する
          </a>
      </p>
    </div>

          <h1 id=clickhouse-testing>ClickHouseのテスト<a class=headerlink href=../amp/#clickhouse-testing title="Permanent link"> </a></h1><h2 id=functional-tests>機能テスト<a class=headerlink href=../amp/#functional-tests title="Permanent link"> </a></h2><p>機能テストは、最も簡単で使いやすいです。 ClickHouseの機能のほとんどは機能テストでテストすることができ、そのようにテストできるClickHouseコードのすべての変更に使用することが必須です。</p><p>各機能テストは、実行中のClickHouseサーバーに一つまたは複数のクエリを送信し、結果を参照と比較します。</p><p>テストは <code class=syntax>queries</code> ディレクトリ。 サブディレクトリは二つあります: <code class=syntax>stateless</code> と <code class=syntax>stateful</code>. ステートレステストは、プリロードされたテストデータなしでクエリを実行します。 状態での検査が必要とな予圧試験データからのYandex.Metricaおよび一般に利用できない。 私たちは使用する傾向があります <code class=syntax>stateless</code> テストと新しい追加を避ける <code class=syntax>stateful</code> テストだ</p><p>それぞれの試験できるの種類: <code class=syntax>.sql</code> と <code class=syntax>.sh</code>. <code class=syntax>.sql</code> testは、パイプ処理される単純なSQLスクリプトです <code class=syntax>clickhouse-client --multiquery --testmode</code>. <code class=syntax>.sh</code> testは、それ自体で実行されるスクリプトです。</p><p>すべてのテストを実行するには、 <code class=syntax>clickhouse-test</code> ツール。 見て！ <code class=syntax>--help</code> 可能なオプションのリスト。 できるだけ実行すべての試験または実行のサブセットの試験フィルター部分文字列の試験名: <code class=syntax>./clickhouse-test substring</code>.</p><p>機能テストを呼び出す最も簡単な方法は、コピーすることです <code class=syntax>clickhouse-client</code> に <code class=syntax>/usr/bin/</code>,run <code class=syntax>clickhouse-server</code> そして、実行 <code class=syntax>./clickhouse-test</code> 独自のディレクトリから。</p><p>新しいテストを追加するには、 <code class=syntax>.sql</code> または <code class=syntax>.sh</code> ファイル <code class=syntax>queries/0_stateless</code> ディレクトリでチェックを手動でその生成 <code class=syntax>.reference</code> 次の方法でファイル: <code class=syntax>clickhouse-client -n --testmode &lt; 00000_test.sql &gt; 00000_test.reference</code> または <code class=syntax>./00000_test.sh &gt; ./00000_test.reference</code>.</p><p>テストでは、テーブルのみを使用（create、dropなど）する必要があります <code class=syntax>test</code> また、テストでは一時テーブルを使用することもできます。</p><p>機能テストで分散クエリを使用する場合は、以下を利用できます <code class=syntax>remote</code> テーブル関数 <code class=syntax>127.0.0.{1..2}</code> または、サーバー設定ファイルで次のように定義済みのテストクラスタを使用できます <code class=syntax>test_shard_localhost</code>.</p><p>いくつかのテストには <code class=syntax>zookeeper</code>, <code class=syntax>shard</code> または <code class=syntax>long</code> 彼らの名前で。<br><code class=syntax>zookeeper</code> ZooKeeperを使用しているテスト用です。 <code class=syntax>shard</code> そのテストのためです<br> サーバーにリッスンが必要 <code class=syntax>127.0.0.*</code>; <code class=syntax>distributed</code> または <code class=syntax>global</code> 同じを持っている<br> 意味だ <code class=syntax>long</code> 少し長く実行されるテストのためのものです。 あなたはできる<br> disableこれらのグループの試験を使用 <code class=syntax>--no-zookeeper</code>, <code class=syntax>--no-shard</code> と<br><code class=syntax>--no-long</code> オプション、それぞれ。</p><h2 id=known-bugs>既知のバグ<a class=headerlink href=../amp/#known-bugs title="Permanent link"> </a></h2><p>機能テストで簡単に再現できるいくつかのバグがわかっている場合は、準備された機能テストを <code class=syntax>tests/queries/bugs</code> ディレクトリ。 これらのテストは <code class=syntax>tests/queries/0_stateless</code> バグが修正されたとき。</p><h2 id=integration-tests>統合テスト<a class=headerlink href=../amp/#integration-tests title="Permanent link"> </a></h2><p>統合テストでは、クラスター化された構成でClickHouseをテストし、Mysql、Postgres、MongoDBなどの他のサーバーとClickHouseの相互作用をテストできます。 これらをエミュレートするネットワーク分割、パケットの落下など。 これらの試験する方向に作用しDockerを複数の容器を様々なソフトウェアです。</p><p>見る <code class=syntax>tests/integration/README.md</code> これらのテストを実行する方法について。</p><p>この統合ClickHouse第三者によるドライバーではない。 また、現在、JDBCおよびODBCドライバとの統合テストはありません。</p><h2 id=unit-tests>単体テスト<a class=headerlink href=../amp/#unit-tests title="Permanent link"> </a></h2><p>単体テストは、ClickHouse全体ではなく、単一の孤立したライブラリまたはクラスをテストする場合に便利です。 テストのビルドを有効または無効にするには <code class=syntax>ENABLE_TESTS</code> CMakeオプション。 単体テスト(およびその他のテストプログラム)は <code class=syntax>tests</code> コード全体のサブディレクトリ。 単体テストを実行するには、 <code class=syntax>ninja test</code>. 一部のテストでは <code class=syntax>gtest</code> しかし、いくつかは、テストの失敗でゼロ以外の終了コードを返すプログラムです。</p><p>コードがすでに機能テストでカバーされている場合は、必ずしも単体テストを持つとは限りません（機能テストは通常ははるかに簡単です）。</p><h2 id=performance-tests>性能テスト<a class=headerlink href=../amp/#performance-tests title="Permanent link"> </a></h2><p>パフォーマ テストは <code class=syntax>tests/performance</code>. それぞれの試験に代表される <code class=syntax>.xml</code> テストケースの説明を持つファイル。 テストは以下で実行されます <code class=syntax>clickhouse performance-test</code> ツール(埋め込まれている <code class=syntax>clickhouse</code> バイナリ）。 見る <code class=syntax>--help</code> 呼び出し用。</p><p>それぞれの試験実行または複数のクエリ(このパラメータの組み合わせ）のループ条件のための停止など “maximum execution speed is not changing in three seconds” 測定一部の指標につクエリの性能など “maximum execution speed”). いくつかの試験を含むことができ前提条件に予圧試験データを得る。</p><p>いくつかのシナリオでClickHouseのパフォーマンスを向上させたい場合や、単純なクエリで改善が見られる場合は、パフォーマンステストを作成することを強 いう意味があるのに使用 <code class=syntax>perf top</code> またはあなたのテストの間の他のperf用具。</p><h2 id=test-tools-and-scripts>テストツールとスクリプ<a class=headerlink href=../amp/#test-tools-and-scripts title="Permanent link"> </a></h2><p>一部のプログラム <code class=syntax>tests</code> ディレク 例えば、 <code class=syntax>Lexer</code> ツールがあります <code class=syntax>src/Parsers/tests/lexer</code> それはstdinのトークン化を行い、色付けされた結果をstdoutに書き込みます。 これらの種類のツールは、コード例として、また探索と手動テストに使用できます。</p><p>でも一対のファイル <code class=syntax>.sh</code> と <code class=syntax>.reference</code> いくつかの事前定義された入力でそれを実行するためのツールと一緒に-その後、スクリプトの結果は <code class=syntax>.reference</code> ファイル これらの種類のテストは自動化されていません。</p><h2 id=miscellaneous-tests>その他のテスト<a class=headerlink href=../amp/#miscellaneous-tests title="Permanent link"> </a></h2><p>外部辞書のテストは次の場所にあります <code class=syntax>tests/external_dictionaries</code> そして機械学んだモデルのために <code class=syntax>tests/external_models</code>. これらのテストは更新されず、統合テストに転送する必要があります。</p><p>クォーラム挿入には別のテストがあります。 このテストでは、ネットワーク分割、パケットドロップ（ClickHouseノード間、ClickHouseとZooKeeper間、ClickHouseサーバーとクライアント間など）など、さまざまな障害ケースをエミュレートします。), <code class=syntax>kill -9</code>, <code class=syntax>kill -STOP</code> と <code class=syntax>kill -CONT</code> 例えば <a href=https://aphyr.com/tags/Jepsen rel="external nofollow noreferrer" target=_blank>ジェプセン</a>. その後、試験チェックすべての認識を挿入したすべて拒否された挿入しました。</p><p>定足数を緩和試験の筆に別々のチーム前ClickHouseしたオープン達した. このチームはClickHouseでは動作しなくなりました。 テストは誤ってJavaで書かれました。 これらのことから、決議の定足数テストを書き換え及び移転統合。</p><h2 id=manual-testing>手動テスト<a class=headerlink href=../amp/#manual-testing title="Permanent link"> </a></h2><p>新しい機能を開発するときは、手動でもテストするのが妥当です。 これを行うには、次の手順を実行します:</p><p>ClickHouseを構築します。 ターミナルからClickHouseを実行します。 <code class=syntax>programs/clickhouse-server</code> そして、それを実行します <code class=syntax>./clickhouse-server</code>. それは構成を使用します (<code class=syntax>config.xml</code>, <code class=syntax>users.xml</code> そして内のファイル <code class=syntax>config.d</code> と <code class=syntax>users.d</code> ディレクトリ)から、現在のディレクトリがデフォルトです。 ClickHouseサーバーに接続するには、以下を実行します <code class=syntax>programs/clickhouse-client/clickhouse-client</code>.</p><p>これらのclickhouseツール（サーバ、クライアント、などだそうでsymlinks単一のバイナリ名 <code class=syntax>clickhouse</code>. このバイナリは <code class=syntax>programs/clickhouse</code>. すべてのツ <code class=syntax>clickhouse tool</code> 代わりに <code class=syntax>clickhouse-tool</code>.</p><p>またインストールすることができClickHouseパッケージは安定したリリースからのYandexリポジトリあるいはすることで作ることができるパッケージで <code class=syntax>./release</code> ClickHouseソースルートで. 次に、サーバーを起動します <code class=syntax>sudo service clickhouse-server start</code> (または停止してサーバーを停止します)。 ログを探す <code class=syntax>/etc/clickhouse-server/clickhouse-server.log</code>.</p><p>時ClickHouseでに既にインストールされているシステムを構築できる新しい <code class=syntax>clickhouse</code> 既存のバイナリを置き換えます:</p><div class=codehilite><pre><span></span><code class=syntax>$ sudo service clickhouse-server stop
$ sudo cp ./clickhouse /usr/bin/
$ sudo service clickhouse-server start
</code></pre></div><p>また、システムclickhouse-serverを停止し、同じ構成ではなく端末にログインして独自のものを実行することもできます:</p><div class=codehilite><pre><span></span><code class=syntax>$ sudo service clickhouse-server stop
$ sudo -u clickhouse /usr/bin/clickhouse server --config-file /etc/clickhouse-server/config.xml
</code></pre></div><p>Gdbの例:</p><div class=codehilite><pre><span></span><code class=syntax>$ sudo -u clickhouse gdb --args /usr/bin/clickhouse server --config-file /etc/clickhouse-server/config.xml
</code></pre></div><p>システムclickhouse-serverがすでに実行されていて、それを停止したくない場合は、次のポート番号を変更できます <code class=syntax>config.xml</code> （または、ファイル内でそれらを上書きする <code class=syntax>config.d</code> ディレクトリ）、適切なデータパスを提供し、それを実行します。</p><p><code class=syntax>clickhouse</code> バイナリーはほとんどない依存関係の作品を広い範囲のLinuxディストリビューション. サーバー上で変更を迅速かつ汚いテストするには、次のことができます <code class=syntax>scp</code> あなたの新鮮な構築 <code class=syntax>clickhouse</code> あなたのサーバーにバイナリし、上記の例のように実行します。</p><h2 id=testing-environment>テスト環境<a class=headerlink href=../amp/#testing-environment title="Permanent link"> </a></h2><p>リリースを安定版として公開する前に、テスト環境に展開します。 テスト環境は1/39の部分を処理する集りです <a href=https://metrica.yandex.com/ rel="external nofollow noreferrer" target=_blank>Yandex.メトリカ</a> データ テスト環境をYandexと共有しています。メトリカ-チーム ClickHouseは既存のデータの上にダウンタイムなしで改善される。 私たちは、データがリアルタイムから遅れることなく正常に処理され、複製が動作し続け、Yandexに見える問題はないことを最初に見ています。メトリカ-チーム 最初のチェックは、次の方法で行うことができます:</p><div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>hostName</span><span class=p>()</span> <span class=k>AS</span> <span class=n>h</span><span class=p>,</span> <span class=k>any</span><span class=p>(</span><span class=k>version</span><span class=p>()),</span> <span class=k>any</span><span class=p>(</span><span class=n>uptime</span><span class=p>()),</span> <span class=k>max</span><span class=p>(</span><span class=n>UTCEventTime</span><span class=p>),</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=n>remote</span><span class=p>(</span><span class=s1>'example01-01-{1..3}t'</span><span class=p>,</span> <span class=n>merge</span><span class=p>,</span> <span class=n>hits</span><span class=p>)</span> <span class=k>WHERE</span> <span class=n>EventDate</span> <span class=o>&gt;=</span> <span class=n>today</span><span class=p>()</span> <span class=o>-</span> <span class=mi>2</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>h</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=n>h</span><span class=p>;</span>
</code></pre></div><p>市場、クラウドなど：いくつかのケースでは、我々はまた、Yandexの中で私たちの友人チームのテスト環境に展開します また、開発目的で使用されるハードウェアサーバーもあります。</p><h2 id=load-testing>負荷テスト<a class=headerlink href=../amp/#load-testing title="Permanent link"> </a></h2><p>後の展開を試験環境を実行負荷テストクエリから生産ます。 これは手動で行われます。</p><p>有効にしていることを確認します <code class=syntax>query_log</code> 運用クラスター上。</p><p>一日以上のクエリログを収集する:</p><div class=codehilite><pre><span></span><code class=syntax>$ clickhouse-client --query<span class=o>=</span><span class=s2>"SELECT DISTINCT query FROM system.query_log WHERE event_date = today() AND query LIKE '%ym:%' AND query NOT LIKE '%system.query_log%' AND type = 2 AND is_initial_query"</span> &gt; queries.tsv
</code></pre></div><p>これは複雑な例です。 <code class=syntax>type = 2</code> 正常に実行されたクエリをフィルタ処理します。 <code class=syntax>query LIKE '%ym:%'</code> Yandexから関連するクエリを選択することです。メトリカ <code class=syntax>is_initial_query</code> ClickHouse自体ではなく、クライアントによって開始されたクエリのみを選択することです（分散クエリ処理の一部として）。</p><p><code class=syntax>scp</code> このログをテストクラスタに記録し、次のように実行します:</p><div class=codehilite><pre><span></span><code class=syntax>$ clickhouse benchmark --concurrency <span class=m>16</span> &lt; queries.tsv
</code></pre></div><p>（おそらくあなたはまた、 <code class=syntax>--user</code>)</p><p>それから夜または週末のためにそれを残し、残りを取る行きなさい。</p><p>きることを確認 <code class=syntax>clickhouse-server</code> なクラッシュメモリのフットプリントは有界性なつ品位を傷つける。</p><p>クエリと環境の変動が大きいため、正確なクエリ実行タイミングは記録されず、比較されません。</p><h2 id=build-tests>ビルドテスト<a class=headerlink href=../amp/#build-tests title="Permanent link"> </a></h2><p>構築を試験できることを確認の構築においても様々な代替構成されており、外国のシステム。 テストは <code class=syntax>ci</code> ディレクトリ。 Docker、Vagrant、時には以下のようなソースからビルドを実行します <code class=syntax>qemu-user-static</code> ドッカー内部。 これらのテストは開発中であり、テストの実行は自動化されません。</p><p>動機:</p><p>通常、ClickHouse buildの単一のバリアントですべてのテストをリリースして実行します。 しかし、徹底的にテストされていない別のビルド変種があります。 例:</p><ul><li>FreeBSD上でビルド;</li><li>をDebianを対象として図書館システムのパッケージ;</li><li>ライブラリの共有リンクでビルド;</li><li>AArch64プラットフォ;</li><li>PowerPcプラットフォーム上で構築。</li></ul><p>たとえば、システムパッケージを使用したビルドは悪い習慣です。 しかし、これは本当にDebianメンテナに必要です。 このため、少なくともこのビルドの変種をサポートする必要があります。 別の例：共有リンクは一般的な問題の原因ですが、一部の愛好家にとって必要です。</p><p>ができませんので実行した全試験はすべての変異体を構築し、チェックしたい少なくとも上記に記載された各種の構築異な破となりました。 この目的のためにビルドテストを使用します。</p><h2 id=testing-for-protocol-compatibility>プロトコル互換性のテスト<a class=headerlink href=../amp/#testing-for-protocol-compatibility title="Permanent link"> </a></h2><p>ClickHouse network protocolを拡張すると、古いclickhouse-clientが新しいclickhouse-serverで動作し、新しいclickhouse-clientが古いclickhouse-serverで動作することを手動でテストします（対応するパッケージからバイナリを</p><h2 id=help-from-the-compiler>コンパイラからのヘルプ<a class=headerlink href=../amp/#help-from-the-compiler title="Permanent link"> </a></h2><p>メインクリックハウスコード（にある <code class=syntax>dbms</code> ディレクトリ)は <code class=syntax>-Wall -Wextra -Werror</code> そして、いくつかの追加の有効な警告と。 これらのオプションは有効になっていないためにサードパーティーのライブラリ.</p><p>Clangにはさらに便利な警告があります。 <code class=syntax>-Weverything</code> デフォルトのビルドに何かを選ぶ。</p><p>本番ビルドでは、gccが使用されます（clangよりもやや効率的なコードが生成されます）。 開発のために、clangは通常、使用する方が便利です。 あなたは（あなたのラップトップのバッテリーを節約するために）デバッグモードで自分のマシン上で構築することができますが、コンパイラがでより <code class=syntax>-O3</code> よりよい制御フローおよびinter-procedure分析が原因で。 Clangでビルドする場合, <code class=syntax>libc++</code> の代わりに使用されます。 <code class=syntax>libstdc++</code> そして、デバッグモードでビルドするとき、 <code class=syntax>libc++</code> 使用可能にするにはより誤差があります。.</p><h2 id=sanitizers>サニタイザー<a class=headerlink href=../amp/#sanitizers title="Permanent link"> </a></h2><p><strong>アドレスsanitizer</strong>.<br> 私たちは、コミットごとにASanの下で機能テストと統合テストを実行します。</p><p><strong>ヴァルグリンド(曖昧さ回避)</strong>.<br> 私たちは一晩Valgrindの下で機能テストを実行します。 数時間かかります。 現在知られている偽陽性があります <code class=syntax>re2</code> 図書館、参照 <a href=https://research.swtch.com/sparse rel="external nofollow noreferrer" target=_blank>この記事</a>.</p><p><strong>未定義の動作のサニタイザー。</strong><br> 私たちは、コミットごとにASanの下で機能テストと統合テストを実行します。</p><p><strong>糸のsanitizer</strong>.<br> 私たちは、コミットごとにTSanの下で機能テストを実行します。 コミットごとにTSanの下で統合テストを実行することはまだありません。</p><p><strong>メモリサニタイザー</strong>.<br> 現在、我々はまだMSanを使用していません。</p><p><strong>デバッグアロケータ。</strong><br> デバッグバージョン <code class=syntax>jemalloc</code> デバッグビルドに使用されます。</p><h2 id=fuzzing>ファジング<a class=headerlink href=../amp/#fuzzing title="Permanent link"> </a></h2><p>ClickHouseファジングは、両方を使用して実装されます <a href=https://llvm.org/docs/LibFuzzer.html rel="external nofollow noreferrer" target=_blank>libFuzzer</a> とランダムSQLクエリ。<br> すべてのファズテストは、サニタイザー（アドレスと未定義）で実行する必要があります。</p><p>LibFuzzerは、ライブラリコードの分離ファズテストに使用されます。 ファザーはテストコードの一部として実装され “_fuzzer” 名前の接尾辞。<br> Fuzzerの例はで見つけることができます <code class=syntax>src/Parsers/tests/lexer_fuzzer.cpp</code>. LibFuzzer固有の設定、辞書、およびコーパスは次の場所に格納されます <code class=syntax>tests/fuzz</code>.<br> ご協力をお願いいたし書きファズ試験べての機能を取り扱うユーザー入力します。</p><p>ファザーはデフォルトではビルドされません。 両方のファザーを構築するには <code class=syntax>-DENABLE_FUZZING=1</code> と <code class=syntax>-DENABLE_TESTS=1</code> 選択は置かれるべきである。<br> ファザーのビルド中にJemallocを無効にすることをお勧めします。 ClickHouseファジングを統合するために使用される設定<br> Google OSS-Fuzzは次の場所にあります <code class=syntax>docker/fuzz</code>.</p><p>また簡単なファズ試験をランダムなSQLクエリーやことを確認するにはサーバーにな金型を実行します。<br> それを見つけることができる <code class=syntax>00746_sql_fuzzy.pl</code>. このテストは、継続的に実行する必要があります（一晩と長い）。</p><h2 id=security-audit>セキュリティ監査<a class=headerlink href=../amp/#security-audit title="Permanent link"> </a></h2><p>人からのYandexセキュリティチームはいくつかの基本的な概要ClickHouse力からのセキュリティの観点から.</p><h2 id=static-analyzers>静的アナライザ<a class=headerlink href=../amp/#static-analyzers title="Permanent link"> </a></h2><p>私たちは走る <code class=syntax>PVS-Studio</code> コミットごと。 私達は評価しました <code class=syntax>clang-tidy</code>, <code class=syntax>Coverity</code>, <code class=syntax>cppcheck</code>, <code class=syntax>PVS-Studio</code>, <code class=syntax>tscancode</code>. 使用のための指示をで見つけます <code class=syntax>tests/instructions/</code> ディレクトリ。 また読むことができます <a href=https://habr.com/company/yandex/blog/342018/ rel="external nofollow noreferrer" target=_blank>ロシア語の記事</a>.</p><p>を使用する場合 <code class=syntax>CLion</code> IDEとして、いくつかを活用できます <code class=syntax>clang-tidy</code> 箱から出してチェックします。</p><h2 id=hardening>硬化<a class=headerlink href=../amp/#hardening title="Permanent link"> </a></h2><p><code class=syntax>FORTIFY_SOURCE</code> デフォルトで使用されます。 それはほとんど役に立たないですが、まれに理にかなっており、それを無効にしません。</p><h2 id=code-style>コードスタイル<a class=headerlink href=../amp/#code-style title="Permanent link"> </a></h2><p>コードのスタイルのルールを記述 <a href=https://clickhouse.tech/docs/en/development/style/ target=_blank>ここに</a>.</p><p>チェックのための、共通したスタイル違反、利用できる <code class=syntax>utils/check-style</code> スクリプト</p><p>コードの適切なスタイルを強制するには、次のようにします <code class=syntax>clang-format</code>. ファイル <code class=syntax>.clang-format</code> ソースルートにあります。 実際のコードスタイルにほとんど対応しています。 しかし、適用することはお勧めしません <code class=syntax>clang-format</code> 既存のファイルへの書式設定が悪化するためです。 以下を使用できます <code class=syntax>clang-format-diff</code> clangソースリポジトリで見つけることができるツール。</p><p>あるいは、 <code class=syntax>uncrustify</code> コードを再フォーマットするツール。 設定は次のとおりです <code class=syntax>uncrustify.cfg</code> ソースルートで。 それはより少なくテストさ <code class=syntax>clang-format</code>.</p><p><code class=syntax>CLion</code> 独自のコードをフォーマッタしていると見ることができる調整のためのコードです。</p><h2 id=metrica-b2b-tests>Metrica B2Bテスト<a class=headerlink href=../amp/#metrica-b2b-tests title="Permanent link"> </a></h2><p>各ClickHouseリリースはYandex MetricaとAppMetricaエンジンでテストされます。 ClickHouseのテスト版と安定版はVmにデプロイされ、入力データの固定サンプルを処理するMetrica engineの小さなコピーで実行されます。 次に，Ｍｅｔｒｉｃａエンジンの二つのインスタンスの結果を比較した。</p><p>これらの試験により自動化されており、別のチームです。 可動部分の高い数が原因で、テストは把握し非常ににくい完全に無関係な理由によって失敗ほとんどの時間です。 がこれらの試験は負の値です。 しかしこれらの試験することが明らかとなったが有用である一又は二倍の数百名</p><h2 id=test-coverage>テスト範囲<a class=headerlink href=../amp/#test-coverage title="Permanent link"> </a></h2><p>2018年現在、テストカバーは行っていない。</p><h2 id=test-automation>テスト自動化<a class=headerlink href=../amp/#test-automation title="Permanent link"> </a></h2><p>Yandex内部CIとジョブ自動化システムという名前のテストを実行します “Sandbox”.</p><p>ビルドジョブとテストは、コミットごとにSandboxで実行されます。 結果のパッケージとテスト結果はGitHubに公開され、直接リンクでダウンロードできます。 成果物は永遠に保存されます。 GitHubでプルリクエストを送信すると、次のようにタグ付けします “can be tested” そして私達のCIシステムはあなたのためのClickHouseのパッケージ（住所sanitizerの解放、デバッグ、等）を造ります。</p><p>時間と計算能力の限界のため、Travis CIは使用しません。<br> ジェンキンスは使わない 以前は使用されていましたが、今はJenkinsを使用していません。</p><p><a href=https://clickhouse.tech/docs/en/development/tests/ target=_blank>元の記事</a> <!--hide--></p>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">評価: RATING_VALUE - RATING_COUNT 投票</p>
  <span class="alert-heading display-6">記事の評価</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2020 Yandex LLC</div>
    <div>から構築 <a href="https://github.com/ClickHouse/ClickHouse/commit/782f2179ce4ad0b9a9c898a5f32557555b59e4d0" rel="external nofollow noreferrer" target="_blank" class="text-reset">782f2179ce</a>, 掲載され <span title="2017-10-25T08:27:09+03:00">2017-10-25</span>, に変更 <span title="2020-05-15T07:34:54+03:00">2020-05-15</span>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.tech/docs/ja/development/tests/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
